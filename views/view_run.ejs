<%

	var req_path = req.path;
	
	var task = {};
	sails.config.tasks.forEach(function(t){
		if(t.config.slug==req.params.slug)
			task = t;
	})
	var folder_path=task.path.replace('api/tasks/','').replace('/'+task.file,'').split('/');

%>
<div class='ui basic segment container'>

	<div class="ui breadcrumb">
		<a class="section" href='/library'>Library</a>
		<% var path = '/library'%>
		<%folder_path.forEach(function(folder){%>
		<% path +='/'+folder%>
		<i class="right angle icon divider"></i>
		<a class="section" href='<%=path%>'><%=folder%></a>
		<%})%>
		<i class="right angle icon divider"></i>
		<a class="section" href='/task/<%=req.params.slug%>'><%=task.config.name%></a>
		<i class="right angle icon divider"></i>
		<div class="section"><%=run.id%></div> 
	</div>
	<h1 style='margin-top:0;'>
		<span style='opacity: 0.5;'>Task Run: </span><span data-content="<%=task.config.name%>"><%= task.config?.name?.length > 47 ? task.config?.name?.substring(0, 47) + '...' : task.config.name %> #<%=run.id%></span>
		
		<div class="ui compact basic icon button right floated dropdown">
			<i class="middle aligned ellipsis vertical icon" style="margin-left: 4px;"></i>
			<div class="menu" style="margin-top: 4px;">
				<div class="item" id="edit_modal">
					<i class="edit icon"></i> Edit
				</div>
			</div>
		</div>
		<a class="ui compact basic button right floated" href='' target='_blank'>
			<i class="file icon"></i> 
			Run again ...
		</a>
		
	</h1>
	<table class="ui celled unstackable collapsing compact table">
	    <tbody>
	    	<tr>
	    	    <td><b>Status</b></td>
	    	    <td><b>Duration</b></td>
	    	</tr>
	        <tr>
	            <td><%=run.status%></td>
	            <td><%=run.duration%>s</td>
	        </tr>
	    </tbody>
	</table>
	<div class="ui divider"></div>

	<h3>Logs:</h3>
	<%run.logs.forEach(function(log){%>
        <span style="color: #aaaaaa;"><%=log.timestamp%>:</span> <%=log.text%><br>
    <%})%>
	<!-- <table class="ui celled unstackable collapsing table">
	    <tbody>
			<%run.logs.forEach(function(log){%>
	        <tr>
	            <td><%=log.timestamp%></td>
	            <td><%=log.text%></td>
	        </tr>
	        <%})%>
	    </tbody>
	</table> -->
	<!-- <pre><%=JSON.stringify(run.logs,2,2)%></pre> -->

	<!-- 
	<h3>Activity</h3>
	<div class='ui grid'>
		<div class='one wide column'>
			<div class='ui basic right aligned segment'>
				<div class="label">
					<i class="big grey circle user icon"></i>
				</div>
			</div>
		</div>
		<div class='fifteen wide column'>
			<div><b>Run started:</b></div>
			<span class='description'>Created At: <%=run.createdAt%> by Alex</span>
			<div class='ui segment'>
				this is a segment
			</div>
		</div>

		<div class='one wide column'>
			<div class='ui basic right aligned segment'>
				<div class="label">
					<i class="big grey sticky note icon"></i>
				</div>
			</div> 
		</div>
		
		<div class='fifteen wide column'>
			<div class='ui segment'>
				About uploaded file:<br>
				File name: 02. Production MIS With Value (India)_32_5305746647329959689.xlsx<br>
				Date: 2024-02-25<br>
				location: india<br>
				Contains sheets: Summary, Detail, WIP, RM, CONSUMABLE, SPARE, RM Purchase, CONSUMABLE Purchase, SPARE Purchase
			</div>
		</div> 
		
		
	</div> -->
	
</div>
